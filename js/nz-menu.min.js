(function (a) {
    a.fn.NZ_Menu = function (e) {
        var c = {items: [], fatype: "fas", bgcolor: "#fff", showbefore: null, showafter: null, closed: null,};
        var b = a.extend({}, c, e);
        if (b.items.length === 0) {
            alert("没有找到菜单项！");
            return false
        }
        a(this).contextmenu(function (h) {
            var f = a(this);
            if (f.data("nzmenuid") === null || typeof f.data("nzmenuid") === "undefined") {
                f.data("nzmenuid", d())
            }
            a(".NZ-Menu").each(function () {
                if (a(this).data("nzmenuid") === f.data("nzmenuid")) {
                    a(this).off("animationend webkitAnimationEnd").addClass("NZ-Menu-hidemenu").on("animationend webkitAnimationEnd", function () {
                        a(this).remove()
                    })
                }
            });
            if (typeof b.showbefore === "function") {
                b.showbefore()
            }
            var g = a('<ul class="NZ-Menu"></ul>');
            var i = a('<li class="hoverlayer"></li>');
            g.append(i).mouseleave(function () {
                i.css({opacity: 0})
            }).data("nzmenuid", f.data("nzmenuid"));
            var j = false;
            a.each(b.items, function (m, o) {
                var n = a('<li class="NZ-Menu-motion NZ-Menu-showitem">' + o.name + "</li>");
                if (typeof o.attrlist !== "undefined" && o.attrlist !== null && o.attrlist.length > 0) {
                    for (var k = 0; k < o.attrlist.length; k++) {
                        n.attr(o.attrlist[k].name, o.attrlist[k].val)
                    }
                }
                if (typeof o.classlist !== "undefined" && o.classlist !== null && o.classlist.length > 0) {
                    for (var l = 0; l < o.classlist.length; l++) {
                        n.addClass(o.classlist[l])
                    }
                }
                if (typeof o.icon !== "undefined" && o.icon !== null && o.icon !== "") {
                    n.append('<i class="' + b.fatype + " " + o.icon + '"></i>');
                    j = true
                }
                n.click(function () {
                    o.event()
                }).mouseenter({e: i}, function (p) {
                    p.data.e.css({opacity: 1, top: a(this).position().top, height: a(this).outerHeight()})
                }).on("animationend webkitAnimationEnd", function (p) {
                    p.stopPropagation()
                });
                g.append(n)
            });
            if (j) {
                g.find("li").addClass("item-icon")
            }
            a(document.body).append(g);
            g.css({left: h.pageX, top: h.pageY});
            g.addClass("NZ-Menu-motion NZ-Menu-showmenu").on("animationend webkitAnimationEnd", function () {
                if (typeof b.showafter === "function") {
                    b.showafter()
                }
                a(this).removeClass("NZ-Menu-showmenu")
            });
            a(document).bind("mousedown.nzmenu", function (k) {
                switch (k.which) {
                    case 1:
                        a(".NZ-Menu").each(function (l) {
                            a(this).off("animationend webkitAnimationEnd").addClass("NZ-Menu-hidemenu").on("animationend webkitAnimationEnd", function () {
                                if (typeof b.closed === "function") {
                                    b.closed()
                                }
                                a(this).remove()
                            })
                        });
                        a(document).unbind("click.nzmenu");
                        break;
                    case 3:
                        break;
                    case 2:
                        break;
                    default:
                        break
                }
            });
            return false
        });
        function d() {
            return "NZ-MENU-" + "xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g, function (f) {
                    var g = Math.random() * 16 | 0, h = f == "x" ? g : (g & 3 | 8);
                    return h.toString(16)
                })
        }
    }
})(jQuery);